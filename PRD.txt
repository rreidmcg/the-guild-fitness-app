# The Guild: Gamified Fitness - Product Requirements Document
# Last Updated: January 12, 2025
# Priority Scale: P0 (Critical) | P1 (High) | P2 (Medium) | P3 (Low)
# Status: ✅ Complete | 🚧 In Progress | 📋 Not Started | ❌ Blocked
# Complexity: 🟢 Simple | 🟡 Medium | 🔴 Complex

================================================================================
PROJECT OVERVIEW
================================================================================
Mission: Transform fitness tracking into an immersive RPG experience
Target: Fitness enthusiasts seeking gamified motivation and long-term engagement
Core Value: Sustainable fitness through character progression and community

================================================================================
1. AUTHENTICATION & USER MANAGEMENT [P0 - ✅ Complete - 🟡 Medium]
================================================================================
1.1 User Registration System [P0 - ✅ Complete - 🟢 Simple]
    - Email/username signup with password validation
    - Profile creation (height, weight, fitness goals, avatar preferences)
    - Liability waiver acceptance during registration

1.2 Login/Logout System [P0 - ✅ Complete - 🟢 Simple]
    - Secure session management with PostgreSQL storage
    - Password hashing with bcrypt
    - Remember me functionality

1.3 Email Verification [P1 - ✅ Complete - 🟡 Medium]
    - Nodemailer integration with Gmail SMTP
    - MailerSend as fallback option
    - Verification token system with expiration

1.4 Password Recovery [P1 - ✅ Complete - 🟡 Medium]
    - Secure reset token generation
    - Email-based password reset flow
    - Token expiration and security measures

1.5 Username Validation [P1 - ✅ Complete - 🟡 Medium]
    - Profanity filtering system
    - Reserved words protection
    - Uniqueness validation

1.6 Admin Access Control [P1 - ✅ Complete - 🟢 Simple]
    - GM title restriction for Zero and Rob
    - Admin-only routes and features
    - Role-based permissions

================================================================================
2. CHARACTER PROGRESSION SYSTEM [P0 - ✅ Complete - 🔴 Complex]
================================================================================
2.1 Core Stats System [P0 - ✅ Complete - 🟡 Medium]
    - Strength, Stamina, Agility tracking
    - Base stats initialization (1 instead of 0)
    - Stat-based combat calculations

2.2 Experience & Leveling [P0 - ✅ Complete - 🟡 Medium]
    - Exponential XP formula for sustainable progression
    - Level-based unlocks and progression gates
    - XP rewards from workouts and battles

2.3 Title & Achievement System [P0 - ✅ Complete - 🔴 Complex]
    - Hierarchical title progression tied to dungeon completion
    - Rarity-based title system (Common to Legendary)
    - Boss-themed achievements and milestones

2.4 Dual Resource System [P0 - ✅ Complete - 🟡 Medium]
    - HP (Health Points) for combat sustainability
    - MP (Magic Points) for special abilities
    - Regeneration mechanics and resource management

2.5 Atrophy Prevention System [P1 - ✅ Complete - 🔴 Complex]
    - Daily activity tracking to prevent stat loss
    - Grace period for new users (7-day immunity)
    - 2-day inactivity threshold before XP loss

================================================================================
3. GAMIFICATION FEATURES [P0 - ✅ Complete - 🔴 Complex]
================================================================================
3.1 Dual Economy System [P0 - ✅ Complete - 🟡 Medium]
    - XP currency from workouts for character progression
    - Gold currency from battles for shop purchases
    - Balanced economy to encourage both activities

3.2 Combat System [P0 - ✅ Complete - 🔴 Complex]
    - Stat-based damage calculations and evasion
    - Monster database with varied difficulty levels
    - Battle rewards and victory conditions

3.3 Streak System [P0 - ✅ Complete - 🟡 Medium]
    - Daily activity streak tracking
    - Automatic streak freeze (3 daily quests required)
    - Streak bonus multipliers for consistent engagement

3.4 Daily Quest System [P0 - ✅ Complete - 🟡 Medium]
    - Randomized daily challenges
    - Quest completion tracking
    - Rewards tied to streak system

3.5 Shop & Wardrobe [P1 - ✅ Complete - 🟡 Medium]
    - Gold-based item purchases
    - Cosmetic wardrobe system
    - Equipment management and visual customization

================================================================================
4. WORKOUT TRACKING SYSTEM [P0 - ✅ Complete - 🔴 Complex]
================================================================================
4.1 Workout Creation [P0 - ✅ Complete - 🟡 Medium]
    - Template-based workout builder
    - Exercise library with categorization
    - JSON-based exercise configuration

4.2 Real-time Session Tracking [P0 - ✅ Complete - 🟡 Medium]
    - Live workout timer and progress tracking
    - Exercise performance recording
    - Real-time stat calculations

4.3 Exercise Library Management [P0 - ✅ Complete - 🟡 Medium]
    - Comprehensive exercise database
    - Multi-stat allocation per exercise
    - Category-based organization

4.4 Personal Records Tracking [P0 - ✅ Complete - 🟢 Simple]
    - Automatic PR detection and recording
    - Historical performance tracking
    - Achievement unlocks for milestones

4.5 Post-Workout Victory Screen [P1 - ✅ Complete - 🟢 Simple]
    - XP and stat gains visualization
    - Motivational feedback system
    - Progress celebration mechanics

================================================================================
5. TRAINING PROGRAMS SYSTEM [P1 - 🚧 In Progress - 🔴 Complex]
================================================================================
5.1 Program Data Structure [P1 - ✅ Complete - 🟡 Medium]
    - Multi-week program scheduling
    - Day-by-day workout assignments
    - Coach notes and progression guidance

5.2 Program Builder Interface [P1 - ✅ Complete - 🔴 Complex]
    - Week/day structure creation
    - Workout assignment to program days
    - Program metadata management (duration, difficulty, goals)

5.3 Program Integration [P1 - 🚧 In Progress - 🟡 Medium]
    Dependencies: 5.1, 5.2
    - Training programs in workout programs list ✅
    - Individual program detail pages ✅
    - Program navigation consistency 🚧

5.4 Progress Tracking [P1 - ✅ Complete - 🟡 Medium]
    - User completion status per day/week
    - Progress persistence across sessions
    - Completion analytics and reporting

5.5 Coach Dashboard [P2 - 📋 Not Started - 🔴 Complex]
    Dependencies: 5.1, 5.2, 5.3, 5.4
    - Coach user role management
    - Client assignment and monitoring
    - Program performance analytics

================================================================================
6. ADMIN & ANALYTICS [P1 - ✅ Complete - 🔴 Complex]
================================================================================
6.1 User Management Dashboard [P1 - ✅ Complete - 🟡 Medium]
    - User list with detailed stats
    - Admin actions (ban, promote, etc.)
    - System statistics overview

6.2 Analytics Service [P1 - ✅ Complete - 🔴 Complex]
    - Real-time user engagement metrics
    - Retention analysis and reporting
    - Revenue projections and tracking

6.3 Custom Avatar Management [P1 - ✅ Complete - 🔴 Complex]
    - Object storage integration for avatar uploads
    - Admin avatar approval workflow
    - Avatar serving and caching system

6.4 Development Tools [P2 - ✅ Complete - 🔴 Complex]
    - AI-powered code review and optimization
    - OpenAI GPT-4o integration for development assistance
    - Admin-only dev tools interface

================================================================================
7. MONETIZATION FEATURES [P2 - ✅ Complete - 🟡 Medium]
================================================================================
7.1 Stripe Payment Integration [P2 - ✅ Complete - 🟡 Medium]
    - One-time workout program purchases
    - Secure payment processing
    - Purchase confirmation and access management

7.2 Gems Currency System [P2 - ✅ Complete - 🟢 Simple]
    - Premium currency for consumables
    - Streak freeze purchases
    - In-app purchase flow

================================================================================
8. USER EXPERIENCE & ONBOARDING [P1 - ✅ Complete - 🟡 Medium]
================================================================================
8.1 Guided Onboarding Tour [P1 - ✅ Complete - 🟡 Medium]
    - Interactive tutorial system
    - Feature introduction sequence
    - Replay functionality in settings

8.2 Help & FAQ System [P1 - ✅ Complete - 🟢 Simple]
    - Comprehensive FAQ integration
    - Contextual help tooltips
    - User guidance for complex features

8.3 Mail System [P1 - ✅ Complete - 🟡 Medium]
    - In-app notification system
    - Welcome messages for new users
    - System announcements and updates

================================================================================
9. TECHNICAL INFRASTRUCTURE [P0 - ✅ Complete - 🔴 Complex]
================================================================================
9.1 Database Architecture [P0 - ✅ Complete - 🔴 Complex]
    - PostgreSQL with Drizzle ORM
    - Neon serverless PostgreSQL integration
    - Session storage and management

9.2 Frontend Architecture [P0 - ✅ Complete - 🟡 Medium]
    - React with TypeScript
    - Vite build system with hot reload
    - Wouter routing and TanStack Query

9.3 Object Storage System [P1 - ✅ Complete - 🔴 Complex]
    - Google Cloud Storage integration
    - Avatar and asset management
    - Secure file upload and serving

9.4 Email Service Integration [P1 - ✅ Complete - 🟡 Medium]
    - Nodemailer with Gmail SMTP primary
    - MailerSend fallback system
    - Template-based email generation

================================================================================
10. FUTURE ROADMAP [P3 - 📋 Not Started - Various]
================================================================================
10.1 3D Avatar System [P3 - 📋 Not Started - 🔴 Complex]
     Dependencies: 9.3
     - Three.js integration for 3D character display
     - Advanced avatar customization
     - Equipment visualization in 3D

10.2 Dungeon System [P2 - 📋 Not Started - 🔴 Complex]
     Dependencies: 2.1, 2.2, 3.2
     - Story-driven dungeon progression
     - Boss battles and raid mechanics
     - Guild cooperation features

10.3 PvP Battle System [P3 - 📋 Not Started - 🔴 Complex]
     Dependencies: 2.1, 3.2
     - Player vs player combat
     - Ranking and tournament systems
     - Competitive leaderboards

10.4 Social Features [P2 - 📋 Not Started - 🟡 Medium]
     Dependencies: 1.1, 2.1
     - Friend system and social connections
     - Workout sharing and challenges
     - Community features and groups

10.5 Mobile App [P2 - 📋 Not Started - 🔴 Complex]
     Dependencies: All core systems
     - React Native mobile application
     - Push notifications for workouts
     - Offline workout tracking

================================================================================
IMMEDIATE NEXT STEPS (Priority Order)
================================================================================
1. Complete training program navigation (5.3) - 🚧 In Progress
2. Implement coach dashboard (5.5) - Dependencies: 5.3 complete
3. Add dungeon progression system (10.2) - Major feature expansion
4. Develop social features (10.4) - Community engagement
5. Plan 3D avatar integration (10.1) - Visual enhancement

================================================================================
TECHNICAL DEBT & MAINTENANCE
================================================================================
- Leaderboard GM exclusion logic optimization
- Database query performance monitoring
- Error handling standardization across all endpoints
- API documentation and endpoint testing
- Mobile responsiveness improvements
- Accessibility features implementation

================================================================================
DEPENDENCIES MATRIX
================================================================================
5.5 (Coach Dashboard) ← 5.1, 5.2, 5.3, 5.4 (All Training Program features)
10.1 (3D Avatars) ← 9.3 (Object Storage)
10.2 (Dungeons) ← 2.1, 2.2, 3.2 (Character & Combat systems)
10.3 (PvP) ← 2.1, 3.2 (Character & Combat systems)
10.4 (Social) ← 1.1, 2.1 (Auth & Character systems)
10.5 (Mobile) ← All core systems complete

================================================================================